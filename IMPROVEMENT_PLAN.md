# 项目改进计划 (Project Improvement Plan)

本文档旨在记录对 `MdToWeChat` 项目的分析、评估和后续的改进计划，以提升项目的代码质量、可维护性、用户体验和长期发展的潜力。

---

## 一、 总体评价 (Overall Assessment)

这是一个功能完善、设计考虑周全的桌面应用程序，具备商业级应用的雏形。

**优点:**

*   **结构清晰**: `core` 和 `gui` 目录划分明确，核心逻辑与界面展示有效分离。
*   **体验良好**: 自动创建配置、亮/暗模式切换、主题选择、滚动同步等功能，提升了用户体验。
*   **技术扎实**: 正确使用 `QThread` 和 `Worker` 处理耗时操作，保证了UI的流畅响应。
*   **功能强大**: 集成了文章管理、网页抓取、AI 改写、多图文发布等高级功能。

---

## 二、 核心改进领域 (Core Areas for Improvement)

### 1. 代码可维护性与可读性 (Code Maintainability & Readability)

*   **问题**: `gui/main_window.py` 中的 `MainWindow` 类是一个超过700行的“上帝类”，承担了过多职责，难以维护和扩展。
*   **建议**:
    *   **职责分离**: 创建专门的管理器类来分担 `MainWindow` 的职责。
        *   `ArticleManager`: 专门负责文章列表（`self.articles`）的增、删、改、查、排序和文件IO。
        *   `TaskManager`: 统一管理后台任务队列，如抓取和改写。
    *   **简化UI初始化**: 将 `_init_ui` 方法拆分为更小的、职责单一的子方法。
    *   **注释统一与深化**: 将所有代码注释统一为中文，并补充更多“为什么”这么做的注释。

### 2. 软件架构 (Software Architecture)

*   **问题**: 应用的状态（如文章列表 `self.articles`）与视图（`MainWindow`）紧密耦合，不利于状态管理和单元测试。
*   **建议**:
    *   **引入状态管理**: 将 `self.articles` 及其相关操作封装到 `ArticleManager` 中，实现模型和视图的进一步分离。
    *   **依赖注入 (DI)**: 考虑通过构造函数将依赖（如 `MarkdownRenderer`, `WeChatAPI`）“注入”到 `MainWindow` 中，增强代码的模块化和可测试性。

### 3. 用户界面与体验 (UI/UX)

*   **问题**:
    *   缺乏一个常驻的、非干扰性的全局状态反馈机制。
    *   文章列表的排序操作（右键上/下移）在文章较多时效率低下。
*   **建议**:
    *   **增加全局状态栏**: 在主窗口底部增加一个 `QStatusBar`，用于显示全局状态信息。
    *   **实现拖拽排序**: 为左侧的文章列表 `QListWidget` 增加拖拽（Drag and Drop）功能，允许用户直接拖动文章来调整顺序。

### 4. 开发与维护 (Development & Maintenance)

*   **问题**:
    *   配置项在使用时才从 `config.yaml` 中零散读取。
    *   UI中的文本字符串（如按钮文字、菜单项）硬编码在代码中。
*   **建议**:
    *   **集中化配置管理**: 创建一个 `ConfigManager` 类，在程序启动时加载所有配置，并作为单例提供服务。
    *   **字符串常量化**: 将所有UI字符串提取到一个单独的 `constants.py` 文件中，便于修改和未来的国际化。

---

## 三、 行动计划 (Action Plan)

我们将分阶段进行改进，以确保每一步都是安全和可控的。

### **第一阶段：基础优化 (Foundation Enhancement)**

*   **[已完成]** **创建改进计划文档**: 制定并确认改进的蓝图。
*   **[进行中]** **统一并优化注释**: 通读所有 `.py` 文件，将注释统一为中文，并进行优化。
*   **[待办]** **添加全局状态栏**: 在 `MainWindow` 中添加 `QStatusBar` 以提供即时反馈。
*   **[待办]** **实现拖拽排序**: 提升多图文发布的排序效率。

### **第二阶段：架构重构 (Architectural Refactoring)**

*   **[待办]** **创建 `ArticleManager`**: 将文章管理逻辑从 `MainWindow` 中分离出来。
*   **[待办]** **创建 `ConfigManager`**: 集中管理应用的配置。

### **第三阶段：代码质量提升 (Code Quality Improvement)**

*   **[待办]** **常量化UI字符串**: 将硬编码的字符串提取出来。
*   **[待办]** **代码风格检查**: 使用 `flake8` 或 `pylint` 等工具对代码进行一次全面的风格检查和修复。
