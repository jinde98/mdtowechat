# 微信公众号Markdown编辑发布工具

## 1. 项目概述

本项目是一个功能强大的桌面端Markdown编辑器，专为微信公众号运营者设计。它打通了从内容创作、样式渲染到多图文草稿发布的完整工作流，旨在极大提升文章排版和发布的效率。

---

## 2. 核心功能

-   **AI智能创作**：
    -   **网页抓取与AI重写**：输入一个网址，程序能自动抓取网页核心内容，并调用大语言模型（LLM）进行智能分析、排版和润色，一键生成高质量的公众号文章。
    -   **高度可配置**：支持自定义AI模型的API Key、访问地址和System Prompt，让AI的输出更符合你的风格。
-   **多图文创作**：支持在同一窗口下编辑和管理多篇文章，一键发布为多图文草稿。
-   **Markdown实时预览**：左侧编写Markdown，右侧实时显示微信公众号兼容的HTML效果。
-   **粘贴图片自动上传**：从剪贴板粘贴图片，可自动上传至微信图床并替换为Markdown链接，提供无缝的写作体验。
-   **丰富的主题与模式**：
    -   内置多种渲染主题（如默认、蓝莹、极客黑等），一键切换。
    -   支持亮色/暗黑双模式，适应不同工作环境。
-   **强大的模板系统**：
    -   支持自定义页眉和页脚模板，轻松添加固定的推广信息、引导关注等内容。
    -   模板内容与正文完全分离，模板中的图片不会被误用作文章封面。
-   **智能发布流程**：
    -   自动提取标题、摘要和封面图。
    -   发布前弹窗可对所有文章的元数据进行最终确认和修改。
    -   自动处理所有本地和网络图片的上传，并智能缓存，避免重复上传。
    -   发布过程提供实时状态反馈（处理中 -> 成功/失败）。
    -   发布成功后，自动在本地按日期归档所有文章的Markdown和HTML文件。
-   **标准编辑器功能**：支持撤销/重做等标准文本编辑操作。

---

## 3. 项目结构

```
.
├── core/                  # 核心业务逻辑
│   ├── parser.py          # Markdown元数据解析 (标题、封面等)
│   ├── renderer.py        # Markdown到HTML的渲染引擎
│   ├── storage.py         # 本地文章存储管理
│   ├── template_manager.py# 页眉/页脚模板管理
│   ├── wechat_api.py      # 封装所有微信API的调用
│   ├── crawler.py         # 网页内容抓取模块
│   └── llm.py             # 大语言模型交互模块
│
├── gui/                   # 图形用户界面
│   ├── editor.py          # 自定义编辑器(实现粘贴上传)
│   ├── main_window.py     # 应用主窗口
│   ├── publish_dialog.py  # 发布前确认对话框
│   ├── status_dialog.py   # 发布状态对话框
│   ├── template_editor.py # 模板编辑器窗口
│   ├── crawl_dialog.py    # 抓取文章对话框
│   └── settings_dialog.py # 设置对话框
│
├── styles/                # CSS样式文件
│
├── templates/             # 页眉/页脚模板文件
│   ├── header.md
│   └── footer.md
│
├── data/                  # 已发布文章的本地存档
├── logs/                  # 运行日志
├── assets/                # 静态资源 (如默认封面)
├── temp_images/           # 粘贴上传时的临时图片缓存
│
├── main.py                # 应用主入口
├── config.yaml            # 全局配置文件
├── requirements.txt       # Python依赖
└── README.md              # 项目文档
```

---

## 4. 安装与运行

1.  **克隆项目**
    ```bash
    git clone [项目仓库地址]
    cd mdtowechat
    ```

2.  **安装依赖**
    ```bash
    pip install -r requirements.txt
    ```

3.  **进行配置**
    复制 `config.example.yaml` 为 `config.yaml`，并根据需要填入你的配置信息。
    -   **微信配置**：`app_id`和`app_secret`是发布到公众号所必需的。
    -   **AI配置（可选）**：如果你想使用网页抓取和AI重写功能，可以配置`jina`和`llm`部分。我们已提供默认可用的LLM配置，你可以直接使用或替换为你自己的。
    
    **注意：`config.yaml` 包含了你的敏感信息，不应上传到公共仓库。我们已在 `.gitignore` 中将其忽略。**

4.  **运行程序**
    ```bash
    python main.py
    ```

---

## 5. 未来展望

本项目目前提供的是一个基础且功能完备的桌面应用界面，以及几种精选的Markdown渲染样式。我们深知用户对个性化界面和多样化主题的需求，因此在设计之初便考虑了未来的扩展性。当前的UI和样式仅是起点，后续将支持更丰富、可定制的界面元素和渲染主题，以满足不同用户的审美和使用习惯。

本项目已具备稳定且强大的核心功能，为未来的深度开发奠定了良好基础。后续可以探索的方向包括：

-   **Web版本**：开发一个基于Web的版本，实现跨平台访问和云端同步。
-   **Docker化部署**：为Web版本提供Docker容器化方案，简化部署和运维。
-   **样式市场**：开发一个开放的样式市场，允许用户创建、分享和下载更多渲染主题。
-   **多平台发布**：除了微信公众号，增加对知乎、掘金、博客园等其他内容平台的支持。
-   **性能优化**：对于超长文章或大量图片，将网络请求（如图片上传）异步化处理，防止UI假死，提升流畅度。
